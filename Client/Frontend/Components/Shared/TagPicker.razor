@using API.DTO
<div class="tag-picker">
  <input type="text" class="form-control"
         @bind-value="CurrentTag"
         @bind-value:event="oninput"
         @onkeydown="HandleKeyPress"
         placeholder="Add a tag..." />
</div>

@code {
  [Parameter]
  public List<TagDTO> Tags { get; set; } = new List<TagDTO>();

  [Parameter]
  public EventCallback<List<TagDTO>> TagsChanged { get; set; }

  [Parameter]
  public TagType TagType { get; set; }

  private string CurrentTag;

  private async Task HandleKeyPress(KeyboardEventArgs e)
  {
    if (e.Key == "Enter" && !string.IsNullOrWhiteSpace(CurrentTag))
    {
      var newTag = new TagDTO { Key = CurrentTag.Trim(), Type = TagType };
      if (!Tags.Any(t => t.Key == newTag.Key)) // Prevent duplicates
      {
        Tags.Add(newTag);
        await TagsChanged.InvokeAsync(Tags);
      }
      CurrentTag = string.Empty;
    }
  }
}